<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <style>
      html,
      body.sub2-body {
        overflow-x: visible;
      }
    </style>
    <title>Document</title>
    <link rel="stylesheet" href="css/main.css" />
    <link rel="stylesheet" href="css/main_res.css" />
    <link rel="stylesheet" href="css/sub.css" />
    <link rel="stylesheet" href="css/sub_res.css" />
  </head>
  <body class="sub2-body">
    <div class="wrapper">
      <!-- 
        - #HEADER
        -->
      <header>
        <div class="navWrap">
          <a href="index.html" id="logo"
            ><img src="./image/logo-w.png" alt="로고"
          /></a>
          <nav>
            <ul>
              <li>
                <a href="intro.html">기업소개</a>
              </li>
              <li>
                <a href="business.html">사업분야</a>
              </li>
              <li>
                <a href="esg.html">지속가능경영</a>
              </li>
              <li>
                <a href="marketing.html">홍보센터</a>
              </li>
            </ul>
          </nav>
          <div class="hiddenNav">
            <nav>
              <div class="small">
                <div class="imgPosi">
                  <h2>CHANG</h2>
                  <img
                    src="image/lightsbuildings.jpg"
                    alt="배경화면"
                    loading="lazy"
                  />
                </div>
              </div>
              <ul>
                <li>
                  <a href="intro.html">기업소개</a>
                </li>
                <li>
                  <a href="business.html">사업분야</a>
                </li>
                <li>
                  <a href="esg.html">지속가능경영</a>
                </li>
                <li>
                  <a href="marketing.html">홍보센터</a>
                </li>
              </ul>
            </nav>
          </div>

          <div class="lang">
            <div class="langWrap">
              <ion-icon name="globe-outline"></ion-icon>
              <span>KOR</span>
            </div>

            <ul class="hiddenLang">
              <li>ENG</li>
            </ul>
          </div>
          <div class="toggleBtn">
            <!-- <ion-icon name="menu-outline"></ion-icon> -->
            <div class="toggle">
              <span></span>
              <span></span>
              <span></span>
            </div>
          </div>
        </div>
      </header>
      <!-- 
        - subMenu subMenu2
        -->
      <div class="subMenu subMenu2">
        <h3>사업분야</h3>
      </div>
      <main>
        <section id="value">
          <img src="image/dragbtn.png" alt="Custom Cursor" id="dragBtn" />
          <div class="mainText2">
            <h2>OUR OUTCOMES</h2>
            <h5>프로젝트 성과</h5>
          </div>

          <div class="valueimgs">
            <div class="imgWith">
              <div class="imgText">
                <p>건설 그 이상의 가치 구현</p>
                <h2>Realizing Value Beyond Construction</h2>
              </div>
            </div>
            <div class="imgWith">
              <div class="imgText">
                <p>최고의 기술력</p>
                <h2>Top-tier Technological Expertise</h2>
              </div>
            </div>
            <div class="imgWith">
              <div class="imgText">
                <p>글로벌 인프라</p>
                <h2>Global Infrastructure</h2>
              </div>
            </div>
            <div class="imgWith">
              <div class="imgText">
                <p>첨단 기술 리모델링</p>
                <h2>Cutting-edge Technology Remodeling</h2>
              </div>
            </div>
          </div>
        </section>
        <section id="bus">
          <div class="backImg"></div>
          <div class="wrapCenter">
            <div class="mainText2">
              <h2>BUSINESS AREA</h2>
              <h5>창 건설의 주요 사업부문</h5>
            </div>
            <button class="all">전체 열기</button>
          </div>
          <div class="busContent">
            <ul>
              <li>
                <div class="itemHead">
                  <span>01</span>
                  <strong>주택사업</strong>
                  <div class="dropBtn">
                    <ion-icon name="caret-up-outline"></ion-icon>
                  </div>
                </div>
                <div class="itemContent">
                  <div class="itemWrap">
                    <div class="itemText">
                      <div class="text01">
                        <h3>한국 주거 문화를 선도하는 혁신적인 리더</h3>
                        <p>
                          주택 사업에서 우리는 한국의 주거 문화를 선도하는
                          역할을 하고 있습니다. 고객들의 다양한 요구에 부응하며,
                          고품질 주택을 제공함으로써 삶의 질을 향상시키고
                          있습니다. 지속적인 연구와 개발을 통해 새로운 상품을
                          개발하고, 고객과의 긴밀한 소통을 통해 항상 새로운
                          가치를 창출하고 있습니다.
                        </p>
                      </div>
                    </div>
                    <div class="itemImg">
                      <img
                        src="./image/regent-home.jpg"
                        alt="건물"
                        loading="lazy"
                      />
                    </div>
                  </div>
                </div>
              </li>
              <li>
                <div class="itemHead">
                  <span>02</span>
                  <strong>건축사업</strong>
                  <div class="dropBtn">
                    <ion-icon name="caret-up-outline"></ion-icon>
                  </div>
                </div>
                <div class="itemContent">
                  <div class="itemWrap">
                    <div class="itemText">
                      <div class="text01">
                        <h3>
                          혁신적인 디자인과 기술력을 바탕으로 선도하는 건축
                        </h3>
                        <p>
                          건축 분야에서 혁신적인 디자인과 기술력을 바탕으로
                          선도적인 역할을 하고 있습니다. 고객의 요구와 기대를
                          충족시키기 위해 새로운 아이디어와 접근 방식을 적용하고
                          있습니다. 최신 기술을 활용하여 안전하고 지속 가능한
                          건물을 건설하며, 도시의 미래를 책임지고 있습니다.
                        </p>
                      </div>
                    </div>
                    <div class="itemImg">
                      <img
                        src="./image/concerthall.jpg"
                        alt=""
                        loading="lazy"
                      />
                    </div>
                  </div>
                </div>
              </li>
              <li>
                <div class="itemHead">
                  <span>03</span>
                  <strong>토목사업</strong>
                  <div class="dropBtn">
                    <ion-icon name="caret-up-outline"></ion-icon>
                  </div>
                </div>
                <div class="itemContent">
                  <div class="itemWrap">
                    <div class="itemText">
                      <div class="text01">
                        <h3>지속 가능한 도시 인프라를 구축하는 선도 기업</h3>
                        <p>
                          토목사업 분야에서 지속 가능한 도시 인프라를 구축하는
                          선도 기업으로서, 환경 보호와 도시 발전에 기여하고
                          있습니다. 첨단 기술과 전문 지식을 바탕으로 다양한
                          프로젝트를 성공적으로 수행하며, 고객들에게 가치 있는
                          서비스를 제공하고 있습니다
                        </p>
                      </div>
                    </div>
                    <div class="itemImg">
                      <img
                        src="./image/train-station-sunset.jpg"
                        alt="기차역"
                        loading="lazy"
                      />
                    </div>
                  </div>
                </div>
              </li>
            </ul>
          </div>
        </section>

        <div class="sticky_parent">
          <div class="sticky">
            <div class="backImg"></div>
            <div class="scroll_section">
              <div class="mainText2">
                <h2>INNOVATION</h2>
                <h5>혁신, 그 이상</h5>
              </div>

              <div class="innoCon1">
                <img
                  src="./image/high-angle-pie-chart-with-cities.jpg"
                  alt="건축물"
                  loading="lazy"
                />
                <p>
                  기존 사업 역량을 바탕으로 고객의 Needs에 기반한 신사업 기회
                  창출을 통해 새로운 도약을 준비합니다.
                </p>
              </div>

              <div class="innoCon2">
                <p>
                  조경, 항만, 수해상습지 개선 사업, 교육 시설 등 스마트 친환경
                  기술과 공법을 적용한 편의시설을 통해 고객 만족과 일상의
                  편의성을 높였습니다.
                </p>
                <ul>
                  <li>
                    <div class="imgPosi">
                      <img src="./image/b-icon3.png" alt="아이콘1" />
                    </div>
                    <p class="num">1250</p>
                    <img
                      src="image/plus.png"
                      alt="사람 아이콘"
                      class="plusIcon"
                    />
                    <p>직원 수</p>
                  </li>
                  <li>
                    <div class="imgPosi">
                      <img src="./image/b-icon2.png" alt="퍼즐 아이콘" />
                    </div>
                    <p class="num">354</p>
                    <img src="image/plus.png" alt="아이콘" class="plusIcon" />
                    <p>프로젝트</p>
                  </li>
                  <li>
                    <div class="imgPosi">
                      <img src="./image/b-icon1.png" alt="트로피 아이콘" />
                    </div>
                    <p class="num">102</p>
                    <img src="image/plus.png" alt="아이콘" class="plusIcon" />
                    <p>수상</p>
                  </li>
                </ul>
              </div>

              <div class="innoCon3">
                <h2>Leading the Way in Infrastructure Development</h2>
                <p>
                  더 높은 하늘을 향해, 더 넓은 세계를 향해 <br />인류에 대한 더
                  깊은 열정으로<br />
                  계속해서 새로운 세계를 건설합니다
                </p>
                <img
                  src="./image/brown-white.jpg"
                  alt="배경화면"
                  loading="lazy"
                />
                <img
                  src="./image/cityscape.jpg"
                  alt="배경화면"
                  loading="lazy"
                />
              </div>
            </div>
          </div>
        </div>
        <section id="innoGood">
          <div class="backImg"></div>
          <div class="wrapCenter">
            <div class="mainText2">
              <h3>
                창 건설의<br />
                끝없는 도전
              </h3>
            </div>

            <div class="innoText">
              <ul>
                <li>
                  가장 선진적인 주거문화를 제시하며 라이프스타일 트렌드를 선도
                </li>
                <li>다양하게 디자인할 수 있는 소형 주거 상품 개발</li>
                <li>
                  특별한 주거 공간을 원하는 고객들을 위해 품격 있는 주거 복합
                  시설
                </li>
              </ul>
            </div>
          </div>
        </section>
      </main>
      <!-- 
         - #FOOTER
        -->
      <footer>
        <div class="footerWrap">
          <div class="footerLeft">
            <a href="index.html"><img src="image/logo-w.png" alt="로고" /></a>
            <div class="fText">
              <span><a href="#">개인정보처리방침</a></span>
              <span><a href="#">법적고지</a></span>
              <span><a href="#">수출입경영방침</a></span>
              <span><a href="#">공시정보관리규정</a></span>
              <span><a href="#">고객센터</a></span>
              <span><a href="#">오시는 길</a></span>
            </div>
            <div class="fLink">
              <span><a href="#">기업소개</a></span>
              <span><a href="#">사업분야</a></span>
              <span><a href="#">지속가능경영</a></span>
              <span><a href="#">홍보센터</a></span>
            </div>
            <div class="fSmallText">
              <p>인천광역시 연수구 아카데미로 23 <span>032-4512-4545</span></p>
              <p>© CHANG Construction INC. ALL RIGHT RESERVED</p>
            </div>
          </div>
          <div class="footerRight">
            <div class="fSite">
              <select name="menu" id="menu">
                <option value="" disabled selected>Family Site</option>
                <option value="com1">대진 기획사</option>
                <option value="com2">용방 건축</option>
              </select>
              <ion-icon name="chevron-down-outline"></ion-icon>
            </div>
            <div class="social">
              <ion-icon name="logo-facebook"></ion-icon>
              <ion-icon name="logo-youtube"></ion-icon>
              <ion-icon name="logo-instagram"></ion-icon>
            </div>
          </div>
        </div>
      </footer>
      <!-- 
        - #BACK TO TOP
      -->
      <div class="backtoTop">
        <div class="center">
          <ion-icon name="chevron-up-outline"></ion-icon>
        </div>
      </div>
    </div>
    <script>
      let valueImgs = document.querySelector(".valueimgs");
      let dragBtn = document.querySelector("#dragBtn");

      valueImgs.addEventListener("mouseenter", () => {
        document.body.style.cursor = "none"; // 기본 커서를 숨깁니다.
        dragBtn.style.display = "block"; // 커스텀 이미지를 표시합니다.
      });

      valueImgs.addEventListener("mouseleave", () => {
        document.body.style.cursor = ""; // 커서를 되돌립니다.
        dragBtn.style.display = "none"; // 커스텀 이미지를 숨깁니다.
      });

      document.addEventListener("mousemove", (e) => {
        if (e.target.closest(".valueimgs")) {
          dragBtn.style.left = e.pageX + "px"; // 마우스의 X 위치에 따라 이미지의 왼쪽 위치를 설정합니다.
          dragBtn.style.top = e.pageY + "px"; // 마우스의 Y 위치에 따라 이미지의 위쪽 위치를 설정합니다.
        }
      });

      let isDragging = false,
        startX,
        startScrollLeft;

      const dragStart = (e) => {
        console.log("dragStart");
        isDragging = true;
        valueImgs.classList.add("dragging");
        startX = e.pageX || e.touches[0].pageX;
        startScrollLeft = valueImgs.scrollLeft;
        console.log("startX:", startX, "startScrollLeft:", startScrollLeft);
      };

      const dragging = (e) => {
        if (!isDragging) return;
        e.preventDefault();
        const x = e.pageX || e.touches[0].pageX;
        const walk = (x - startX) * 1.5; // 드래그 속도 조절
        console.log("dragging:", "x:", x, "walk:", walk);
        valueImgs.scrollLeft = startScrollLeft - walk;
      };

      const dragStop = () => {
        console.log("dragStop");
        isDragging = false;
        valueImgs.classList.remove("dragging");
      };

      valueImgs.addEventListener("mousedown", dragStart);
      valueImgs.addEventListener("touchstart", dragStart);

      valueImgs.addEventListener("mousemove", dragging);
      valueImgs.addEventListener("touchmove", dragging);

      valueImgs.addEventListener("mouseup", dragStop);
      valueImgs.addEventListener("touchend", dragStop);
      valueImgs.addEventListener("mouseleave", dragStop);

      //////////////////////////////////////////

      let li = document.querySelectorAll(".busContent li"),
        itemContent = document.querySelectorAll(".itemContent"),
        dropIcon = document.querySelector(".dropBtn ion-icon"),
        allBtn = document.querySelector(".all");

      function checkBtn() {
        let isOpen = false;
        li.forEach((item) => {
          if (item.classList.contains("active")) {
            isOpen = true;
          }
        });

        if (isOpen) {
          allBtn.innerText = "전체 닫기";
          allBtn.style.background = "#0421ff";
          allBtn.style.color = "#fff";
          allBtn.style.border = "1px solid #222";
        } else {
          allBtn.innerText = "전체 열기";
          allBtn.style.background = "transparent";
          allBtn.style.color = "#fff";
          allBtn.style.border = "1px solid #fff";
        }
      }

      function toggleItem(idx) {
        let itemHead = li[idx];
        let icon = itemHead.querySelector("ion-icon");
        let content = itemContent[idx];

        itemHead.classList.toggle("active");
        if (itemHead.classList.contains("active")) {
          content.style.height = content.scrollHeight + "px";
          icon.setAttribute("name", "caret-down-outline");
        } else {
          content.style.height = "0";
          icon.setAttribute("name", "caret-up-outline");
        }
        checkBtn();
      }

      function toggleAllItems() {
        let isOpen = false;

        // 현재 열린 아이템의 개수 확인
        li.forEach((item, idx) => {
          if (item.classList.contains("active")) {
            isOpen = true;
            // 현재 열린 아이템이 있으면 해당 아이템을 닫기
            toggleItem(idx);
          }
        });

        // 모든 아이템이 닫혀있는 경우에만 모든 아이템을 열기
        if (!isOpen) {
          li.forEach((item, idx) => {
            toggleItem(idx);
          });
        }

        checkBtn();
      }

      // 전체 열기 및 전체 닫기 버튼 클릭 이벤트
      allBtn.addEventListener("click", toggleAllItems);

      // 각 아이템 헤드 클릭 이벤트
      li.forEach((itemHead, idx) => {
        itemHead.addEventListener("click", () => {
          toggleItem(idx);
        });
      });

      checkBtn();

      //////////////////////////////////////////
      const stickySections = [...document.querySelectorAll(".sticky")];
      //   let images = [
      //     "https://picsum.photos/id/231/200/300",
      //     "https://picsum.photos/id/236/200/300",
      //     "https://picsum.photos/id/235/200/300",
      //     "https://picsum.photos/id/234/200/300",
      //   ];

      //   images.forEach((img) => {
      //     stickySections.forEach((section) => {
      //       let image = document.createElement("img");
      //       image.src = img;
      //       section.querySelector(".scroll_section").appendChild(image);
      //     });
      //   });

      // window.addEventListener("scroll", (e) => {
      //   for (let i = 0; i < stickySections.length; i++) {
      //     transform(stickySections[i]);
      //   }
      // });
      // function transform(section) {
      //   const offsetTop = section.parentElement.offsetTop;
      //   const scrollSection = section.querySelector(".scroll_section");
      //   let percentage =
      //     ((window.scrollY - offsetTop) / window.innerHeight) * 100;
      //   percentage = percentage < 0 ? 0 : percentage > 400 ? 400 : percentage;
      //   scrollSection.style.transform = `translate3d(${-percentage}vw, 0, 0 )`;
      // }

      window.addEventListener("scroll", () => {
        const stickySections = document.querySelectorAll(".sticky");
        stickySections.forEach((section) => transform(section));
      });

      function transform(section) {
        const offsetTop = section.parentElement.offsetTop;
        const scrollSection = section.querySelector(".scroll_section");
        const viewportHeight = window.innerHeight;
        const scrollPosition = window.scrollY - offsetTop;
        const scrollHeight =
          section.parentElement.scrollHeight - viewportHeight;
        const maxTranslate = scrollSection.scrollWidth - viewportHeight;

        // 스크롤 비율 계산
        let percentage = (scrollPosition / scrollHeight) * maxTranslate;
        percentage = Math.max(0, Math.min(percentage, maxTranslate));

        // transform 적용
        scrollSection.style.transform = `translate3d(${-percentage}px, 0, 0)`;
      }

      /**
       * 숫자 카운팅2
       */
      const innoCon2 = document.querySelector(".innoCon2");
      const counters = innoCon2.querySelectorAll(".num");

      let counterStarted = false;

      function animateValue(obj, start, end, duration) {
        let startTimestamp = null;
        const step = (timestamp) => {
          if (!startTimestamp) startTimestamp = timestamp;
          const progress = Math.min((timestamp - startTimestamp) / duration, 1);
          obj.innerText = Math.floor(progress * (end - start) + start);
          if (progress < 1) {
            window.requestAnimationFrame(step);
          }
        };
        window.requestAnimationFrame(step);
      }

      function startCounters() {
        if (!counterStarted) {
          counterStarted = true;
          counters.forEach((counter) => {
            const endValue = parseInt(counter.innerText);
            animateValue(counter, 0, endValue, 3000);
          });
        }
      }

      window.addEventListener("scroll", () => {
        const innoCon2Position = innoCon2.getBoundingClientRect().left;
        const screenPosition = window.innerWidth / 1.7;
        if (innoCon2Position < screenPosition) {
          console.log("카운터 시작");
          startCounters();
        }
      });
    </script>
    <script src="js/main.js"></script>
    <script
      type="module"
      src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"
    ></script>
    <script
      nomodule
      src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"
    ></script>
  </body>
</html>
